---
title: "P-Splines"
author: "Daniel Schalk"
date: "26 MÃ¤rz 2018"
output: html_document
---

# R splines

```{r}
x = runif(100, -4, 4)


```

# What to look at

- `mboost:::df2lambda` for code that transforms `df` to penalty term `lambda` 
  (Demmler-Reinsch Orthogonalization)
  
- Spline basis comes from `splines::splineDesign` (see `mboost:::bsplines`):
    ```{r}
    knots <- c(1,1.8,3:5,6.5,7,8.1,9.2,10)  # 10 => 10-4 = 6 Basis splines
    x <- seq(min(knots)-1, max(knots)+1, length.out = 501)
    bb <- splineDesign(knots, x = x, outer.ok = TRUE)
    ```
    
- Spline basis is created by `splines.c` of the `R` source within 
  `R-3.4.4\src\library\splines\src\` (download from: 
  https://cran.r-project.org/src/base/R-3/R-3.4.4.tar.gz)
  
- Interesting functions are `basis_funcs` which is called by `spline_basis` 
  which is called by `splines::splineDesign`

# C++ Splines

**Constructor:**

```c++
PSplineBlearner(data::Data* data, const unsigned int& degree, const unsigned int& n_knots,
  const double& penalty, const double& df, const unsigned int& differences)
```

**Constraints:**

- Data has to be **ONE** column
- `df > 0` (very strong penalty if `df = 0`) and `df <= rank(spline basis)` 
  (no penalty if `df = rank(spline basis)`)
- `n_knots >= 0`
- `differences = 0` (ridge penalty) `differences < `

**Member Functions:**

- createEquidistantKnots (n_knots, X)
- findSpan (knots, u)
- basisFuns (degree, knots, u)
- dfToLambda (???)